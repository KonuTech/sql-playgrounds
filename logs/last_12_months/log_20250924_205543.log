2025-09-24 20:55:43,226 - INFO - ğŸ“ Logging to file: /sql-scripts/logs/last_12_months/log_20250924_205543.log
2025-09-24 20:55:43,227 - INFO - ğŸ•’ Execution started at: 2025-09-24T20:55:43.227039
2025-09-24 20:55:43,227 - INFO - âš™ï¸ Backfill configuration: last_12_months
2025-09-24 20:55:43,227 - INFO - ğŸš€ Starting Complete NYC Taxi Database Initialization...
2025-09-24 20:55:43,231 - INFO - âœ… PostgreSQL is ready!
2025-09-24 20:55:43,233 - INFO - ğŸ”§ Step 1: Database Schema Creation
2025-09-24 20:55:43,233 - INFO - ğŸ—ƒï¸ Executing SQL initialization scripts...
2025-09-24 20:55:43,235 - INFO - ğŸ“„ Found 2 SQL scripts to execute
2025-09-24 20:55:43,240 - INFO - ğŸ”§ Executing: 00-postgis-setup.sql
2025-09-24 20:55:43,243 - INFO - âœ… Completed: 00-postgis-setup.sql
2025-09-24 20:55:43,243 - INFO - ğŸ”§ Executing: 01-nyc-taxi-schema.sql
2025-09-24 20:55:43,262 - INFO - âœ… Completed: 01-nyc-taxi-schema.sql
2025-09-24 20:55:43,263 - INFO - âœ… All SQL scripts executed successfully!
2025-09-24 20:55:43,263 - INFO - ğŸ“ Step 2: Loading Taxi Zone Reference Data
2025-09-24 20:55:43,263 - INFO - ğŸ“ Loading taxi zone reference data...
2025-09-24 20:55:43,264 - INFO - ğŸ§¹ Cleaning dictionary tables for fresh data load...
2025-09-24 20:55:43,289 - INFO - âœ… Dictionary tables cleaned
2025-09-24 20:55:43,290 - INFO - ğŸ“¥ Downloading taxi zone reference data...
2025-09-24 20:55:43,290 - INFO - ğŸ“¥ Downloading taxi zone reference data...
2025-09-24 20:55:43,292 - INFO - ğŸ“¥ Downloading taxi_zone_lookup.csv...
2025-09-24 20:55:43,406 - INFO - âœ… Downloaded: taxi_zone_lookup.csv
2025-09-24 20:55:43,407 - INFO - ğŸ“¥ Downloading taxi_zones.zip...
2025-09-24 20:55:43,543 - INFO - âœ… Downloaded: taxi_zones.zip
2025-09-24 20:55:43,591 - INFO - âœ… Extracted shapefile components
2025-09-24 20:55:43,593 - INFO - ğŸ—‘ï¸ Cleaned up ZIP file
2025-09-24 20:55:43,600 - INFO - âœ… All taxi zone reference data files are available
2025-09-24 20:55:43,618 - INFO - âœ… Loaded 263 taxi zones from CSV
2025-09-24 20:55:43,620 - INFO - ğŸ—ºï¸ Loading taxi zone shapes...
2025-09-24 20:55:43,855 - INFO - âœ… Loaded 263 taxi zone shapes
2025-09-24 20:55:43,855 - INFO - ğŸ“š Reloading lookup tables...
2025-09-24 20:55:43,861 - INFO - âœ… Lookup tables reloaded
2025-09-24 20:55:43,862 - INFO - ğŸš• Step 3: Loading Complete Trip Data
2025-09-24 20:55:43,862 - INFO - ğŸš• Loading trip data...
2025-09-24 20:55:43,862 - INFO - ğŸ”„ Backfill mode enabled: last_12_months
2025-09-24 20:55:43,862 - INFO - ğŸ“… Backfill months: 12 months from (2024, 10) to (2025, 9)
2025-09-24 20:55:43,864 - INFO - ğŸ“… Processing 2024-10...
2025-09-24 20:55:43,868 - INFO - ğŸ“¥ Downloading yellow_tripdata_2024-10.parquet from NYC TLC...
2025-09-24 20:55:44,842 - INFO - ğŸ“¥ Progress: 16.3% (10,485,760/64,346,071 bytes)
2025-09-24 20:55:45,765 - INFO - ğŸ“¥ Progress: 32.6% (20,971,520/64,346,071 bytes)
2025-09-24 20:55:46,694 - INFO - ğŸ“¥ Progress: 48.9% (31,457,280/64,346,071 bytes)
2025-09-24 20:55:47,617 - INFO - ğŸ“¥ Progress: 65.2% (41,943,040/64,346,071 bytes)
2025-09-24 20:55:48,547 - INFO - ğŸ“¥ Progress: 81.5% (52,428,800/64,346,071 bytes)
2025-09-24 20:55:49,471 - INFO - ğŸ“¥ Progress: 97.8% (62,914,560/64,346,071 bytes)
2025-09-24 20:55:49,598 - INFO - âœ… Downloaded: yellow_tripdata_2024-10.parquet (64,346,071 bytes)
2025-09-24 20:55:49,603 - INFO - ğŸ“ Started processing log for 2024-10
2025-09-24 20:55:49,603 - INFO - ğŸ“¥ Loading yellow_tripdata_2024-10.parquet...
2025-09-24 20:55:49,981 - INFO - ğŸ“Š File contains 3,833,771 rows
2025-09-24 20:55:50,560 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-24 20:56:54,979 - WARNING - âš ï¸ Found 2 hash collisions within batch - removing duplicates
2025-09-24 20:56:56,049 - INFO - âœ… Generated 3,833,769 unique row hashes
2025-09-24 20:57:04,321 - INFO - ğŸ“¥ yellow_tripdata_2024-10.parquet: Loaded 50,000 rows (5/384 chunks)
2025-09-24 20:57:14,587 - INFO - ğŸ“¥ yellow_tripdata_2024-10.parquet: Loaded 100,000 rows (10/384 chunks)
2025-09-24 20:57:24,952 - INFO - ğŸ“¥ yellow_tripdata_2024-10.parquet: Loaded 150,000 rows (15/384 chunks)
2025-09-24 20:57:34,034 - INFO - ğŸ“¥ yellow_tripdata_2024-10.parquet: Loaded 200,000 rows (20/384 chunks)
2025-09-24 20:57:44,104 - INFO - ğŸ“¥ yellow_tripdata_2024-10.parquet: Loaded 250,000 rows (25/384 chunks)
2025-09-24 20:57:54,072 - INFO - ğŸ“¥ yellow_tripdata_2024-10.parquet: Loaded 300,000 rows (30/384 chunks)
2025-09-24 20:58:03,056 - INFO - ğŸ“¥ yellow_tripdata_2024-10.parquet: Loaded 350,000 rows (35/384 chunks)
2025-09-24 20:58:13,044 - INFO - ğŸ“¥ yellow_tripdata_2024-10.parquet: Loaded 400,000 rows (40/384 chunks)
2025-09-24 20:58:23,174 - INFO - ğŸ“¥ yellow_tripdata_2024-10.parquet: Loaded 450,000 rows (45/384 chunks)
2025-09-24 20:58:32,114 - INFO - ğŸ“¥ yellow_tripdata_2024-10.parquet: Loaded 500,000 rows (50/384 chunks)
2025-09-24 20:58:42,221 - INFO - ğŸ“¥ yellow_tripdata_2024-10.parquet: Loaded 550,000 rows (55/384 chunks)
2025-09-24 20:58:52,235 - INFO - ğŸ“¥ yellow_tripdata_2024-10.parquet: Loaded 600,000 rows (60/384 chunks)
