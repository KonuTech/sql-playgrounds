2025-09-28 18:11:52,939 - INFO - ğŸ“ Logging to file: /sql-scripts/logs/2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08/log_20250928_181152.log
2025-09-28 18:11:52,940 - INFO - ğŸ•’ Execution started at: 2025-09-28T18:11:52.940001
2025-09-28 18:11:52,940 - INFO - âš™ï¸ Backfill configuration: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-28 18:11:52,940 - INFO - ğŸš€ Starting Complete NYC Taxi Database Initialization...
2025-09-28 18:11:52,944 - INFO - âœ… PostgreSQL is ready!
2025-09-28 18:11:52,946 - INFO - ğŸ”§ Step 1: Database Schema Creation
2025-09-28 18:11:52,947 - INFO - ğŸ—ƒï¸ Executing SQL initialization scripts...
2025-09-28 18:11:52,950 - INFO - â„¹ï¸ Superset database already exists
2025-09-28 18:11:52,953 - INFO - ğŸ“„ Found 2 SQL scripts to execute
2025-09-28 18:11:52,957 - INFO - ğŸ”§ Executing: 00-postgis-setup.sql
2025-09-28 18:11:52,960 - INFO - âœ… Completed: 00-postgis-setup.sql
2025-09-28 18:11:52,960 - INFO - ğŸ”§ Executing: 01-nyc-taxi-schema.sql
2025-09-28 18:11:53,019 - INFO - âœ… Completed: 01-nyc-taxi-schema.sql
2025-09-28 18:11:53,019 - INFO - âœ… All SQL scripts executed successfully!
2025-09-28 18:11:53,020 - INFO - ğŸ“ Step 2: Loading Taxi Zone Reference Data
2025-09-28 18:11:53,020 - INFO - ğŸ“ Loading taxi zone reference data...
2025-09-28 18:11:53,020 - INFO - ğŸ§¹ Cleaning dictionary tables for fresh data load...
2025-09-28 18:11:53,041 - INFO - âœ… Dictionary tables cleaned
2025-09-28 18:11:53,041 - INFO - ğŸ“¥ Downloading taxi zone reference data...
2025-09-28 18:11:53,041 - INFO - ğŸ“¥ Downloading taxi zone reference data...
2025-09-28 18:11:53,044 - INFO - ğŸ“¥ Downloading taxi_zone_lookup.csv...
2025-09-28 18:11:53,130 - INFO - âœ… Downloaded: taxi_zone_lookup.csv
2025-09-28 18:11:53,130 - INFO - ğŸ“¥ Downloading taxi_zones.zip...
2025-09-28 18:11:53,273 - INFO - âœ… Downloaded: taxi_zones.zip
2025-09-28 18:11:53,323 - INFO - âœ… Extracted shapefile components
2025-09-28 18:11:53,325 - INFO - ğŸ—‘ï¸ Cleaned up ZIP file
2025-09-28 18:11:53,331 - INFO - âœ… All taxi zone reference data files are available
2025-09-28 18:11:53,346 - INFO - âœ… Loaded 263 taxi zones from CSV
2025-09-28 18:11:53,348 - INFO - ğŸ—ºï¸ Loading taxi zone shapes...
2025-09-28 18:11:53,586 - INFO - âœ… Loaded 263 taxi zone shapes
2025-09-28 18:11:53,586 - INFO - ğŸ“š Reloading lookup tables...
2025-09-28 18:11:53,591 - INFO - âœ… Lookup tables reloaded
2025-09-28 18:11:53,591 - INFO - ğŸŒŸ Populating star schema dimensions...
2025-09-28 18:11:53,591 - INFO - ğŸŒŸ Starting star schema dimension population...
2025-09-28 18:11:53,592 - INFO - ğŸ“ Populating dim_locations...
2025-09-28 18:11:53,594 - INFO - ğŸš— Populating dim_vendor...
2025-09-28 18:11:53,594 - INFO - ğŸ’³ Populating dim_payment_type...
2025-09-28 18:11:53,595 - INFO - ğŸ“Š Populating dim_rate_code...
2025-09-28 18:11:53,616 - INFO - âœ… Star schema dimensions populated successfully!
2025-09-28 18:11:53,616 - INFO - ğŸš• Step 3: Loading Complete Trip Data
2025-09-28 18:11:53,617 - INFO - ğŸš• Loading trip data...
2025-09-28 18:11:53,617 - INFO - ğŸ”„ Backfill mode enabled: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-28 18:11:53,617 - INFO - ğŸ“… Backfill months: 12 months from (2024, 9) to (2025, 8)
2025-09-28 18:11:53,619 - INFO - ğŸ“… Processing 2024-09...
2025-09-28 18:11:53,619 - WARNING - âš ï¸ 2024-09: Previous processing incomplete, will retry
2025-09-28 18:11:53,627 - INFO - ğŸ“‚ File already exists: yellow_tripdata_2024-09.parquet
2025-09-28 18:11:53,632 - INFO - ğŸ“ Started processing log for 2024-09
2025-09-28 18:11:53,632 - INFO - ğŸ“¥ Loading yellow_tripdata_2024-09.parquet...
2025-09-28 18:11:53,966 - INFO - ğŸ“Š File contains 3,633,030 rows
2025-09-28 18:11:54,610 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:11:57,963 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:12:19,876 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:12:23,086 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:12:46,779 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:12:49,889 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:13:13,125 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:13:16,492 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:13:40,748 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:13:43,895 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:14:09,001 - INFO - ğŸ“¥ yellow_tripdata_2024-09.parquet: Processed 500,000 rows - Loaded: 0 normalized, 0 star, 500,000 duplicates, 0 invalid (5/37 chunks)
2025-09-28 18:14:09,002 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:14:12,175 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:14:35,670 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:14:38,752 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:15:02,888 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:15:06,056 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:15:31,207 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:15:34,358 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:15:57,829 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:16:00,931 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:16:26,305 - INFO - ğŸ“¥ yellow_tripdata_2024-09.parquet: Processed 1,000,000 rows - Loaded: 0 normalized, 0 star, 1,000,000 duplicates, 0 invalid (10/37 chunks)
2025-09-28 18:16:26,306 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:16:29,509 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:16:54,851 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:16:57,954 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:17:21,526 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:17:24,692 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:17:48,805 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:17:51,868 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:18:17,298 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:18:20,390 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:18:43,897 - INFO - ğŸ“¥ yellow_tripdata_2024-09.parquet: Processed 1,500,000 rows - Loaded: 0 normalized, 0 star, 1,500,000 duplicates, 0 invalid (15/37 chunks)
2025-09-28 18:18:43,898 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:18:46,998 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:19:12,396 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:19:14,282 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:19:40,423 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:19:42,485 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:20:07,152 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:20:10,254 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:20:34,490 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:20:37,595 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:21:02,803 - INFO - ğŸ“¥ yellow_tripdata_2024-09.parquet: Processed 2,000,000 rows - Loaded: 0 normalized, 0 star, 2,000,000 duplicates, 0 invalid (20/37 chunks)
2025-09-28 18:21:02,804 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:21:05,927 - INFO - âœ… Generated 100,000 unique row hashes
