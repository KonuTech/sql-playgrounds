2025-09-28 17:42:32,041 - INFO - ğŸ“ Logging to file: /sql-scripts/logs/2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08/log_20250928_174232.log
2025-09-28 17:42:32,041 - INFO - ğŸ•’ Execution started at: 2025-09-28T17:42:32.041446
2025-09-28 17:42:32,041 - INFO - âš™ï¸ Backfill configuration: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-28 17:42:32,041 - INFO - ğŸš€ Starting Complete NYC Taxi Database Initialization...
2025-09-28 17:42:32,046 - INFO - âœ… PostgreSQL is ready!
2025-09-28 17:42:32,050 - INFO - ğŸ”§ Step 1: Database Schema Creation
2025-09-28 17:42:32,050 - INFO - ğŸ—ƒï¸ Executing SQL initialization scripts...
2025-09-28 17:42:32,054 - INFO - ğŸ”§ Creating superset database...
2025-09-28 17:42:32,103 - INFO - âœ… Superset database created successfully
2025-09-28 17:42:32,106 - INFO - ğŸ“„ Found 2 SQL scripts to execute
2025-09-28 17:42:32,110 - INFO - ğŸ”§ Executing: 00-postgis-setup.sql
2025-09-28 17:42:32,113 - INFO - âœ… Completed: 00-postgis-setup.sql
2025-09-28 17:42:32,114 - INFO - ğŸ”§ Executing: 01-nyc-taxi-schema.sql
2025-09-28 17:42:32,384 - INFO - âœ… Completed: 01-nyc-taxi-schema.sql
2025-09-28 17:42:32,385 - INFO - âœ… All SQL scripts executed successfully!
2025-09-28 17:42:32,385 - INFO - ğŸ“ Step 2: Loading Taxi Zone Reference Data
2025-09-28 17:42:32,385 - INFO - ğŸ“ Loading taxi zone reference data...
2025-09-28 17:42:32,385 - INFO - ğŸ§¹ Cleaning dictionary tables for fresh data load...
2025-09-28 17:42:32,409 - INFO - âœ… Dictionary tables cleaned
2025-09-28 17:42:32,409 - INFO - ğŸ“¥ Downloading taxi zone reference data...
2025-09-28 17:42:32,410 - INFO - ğŸ“¥ Downloading taxi zone reference data...
2025-09-28 17:42:32,412 - INFO - ğŸ“¥ Downloading taxi_zone_lookup.csv...
2025-09-28 17:42:32,531 - INFO - âœ… Downloaded: taxi_zone_lookup.csv
2025-09-28 17:42:32,531 - INFO - ğŸ“¥ Downloading taxi_zones.zip...
2025-09-28 17:42:32,710 - INFO - âœ… Downloaded: taxi_zones.zip
2025-09-28 17:42:32,763 - INFO - âœ… Extracted shapefile components
2025-09-28 17:42:32,765 - INFO - ğŸ—‘ï¸ Cleaned up ZIP file
2025-09-28 17:42:32,771 - INFO - âœ… All taxi zone reference data files are available
2025-09-28 17:42:32,789 - INFO - âœ… Loaded 263 taxi zones from CSV
2025-09-28 17:42:32,791 - INFO - ğŸ—ºï¸ Loading taxi zone shapes...
2025-09-28 17:42:33,024 - INFO - âœ… Loaded 263 taxi zone shapes
2025-09-28 17:42:33,024 - INFO - ğŸ“š Reloading lookup tables...
2025-09-28 17:42:33,029 - INFO - âœ… Lookup tables reloaded
2025-09-28 17:42:33,029 - INFO - ğŸŒŸ Populating star schema dimensions...
2025-09-28 17:42:33,029 - INFO - ğŸŒŸ Starting star schema dimension population...
2025-09-28 17:42:33,030 - INFO - ğŸ“ Populating dim_locations...
2025-09-28 17:42:33,032 - INFO - ğŸš— Populating dim_vendor...
2025-09-28 17:42:33,033 - INFO - ğŸ’³ Populating dim_payment_type...
2025-09-28 17:42:33,033 - INFO - ğŸ“Š Populating dim_rate_code...
2025-09-28 17:42:33,061 - INFO - âœ… Star schema dimensions populated successfully!
2025-09-28 17:42:33,062 - INFO - ğŸš• Step 3: Loading Complete Trip Data
2025-09-28 17:42:33,062 - INFO - ğŸš• Loading trip data...
2025-09-28 17:42:33,063 - INFO - ğŸ”„ Backfill mode enabled: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-28 17:42:33,063 - INFO - ğŸ“… Backfill months: 12 months from (2024, 9) to (2025, 8)
2025-09-28 17:42:33,064 - INFO - ğŸ“… Processing 2024-09...
2025-09-28 17:42:33,068 - INFO - ğŸ“¥ Downloading yellow_tripdata_2024-09.parquet from NYC TLC...
2025-09-28 17:42:34,111 - INFO - ğŸ“¥ Progress: 17.1% (10,485,760/61,170,186 bytes)
2025-09-28 17:42:35,100 - INFO - ğŸ“¥ Progress: 34.3% (20,971,520/61,170,186 bytes)
2025-09-28 17:42:36,082 - INFO - ğŸ“¥ Progress: 51.4% (31,457,280/61,170,186 bytes)
2025-09-28 17:42:37,083 - INFO - ğŸ“¥ Progress: 68.6% (41,943,040/61,170,186 bytes)
2025-09-28 17:42:38,071 - INFO - ğŸ“¥ Progress: 85.7% (52,428,800/61,170,186 bytes)
2025-09-28 17:42:38,900 - INFO - âœ… Downloaded: yellow_tripdata_2024-09.parquet (61,170,186 bytes)
2025-09-28 17:42:38,906 - INFO - ğŸ“ Started processing log for 2024-09
2025-09-28 17:42:38,906 - INFO - ğŸ“¥ Loading yellow_tripdata_2024-09.parquet...
2025-09-28 17:42:39,320 - INFO - ğŸ“Š File contains 3,633,030 rows
2025-09-28 17:42:39,948 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:42:43,565 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:43:07,479 - INFO - ğŸ—„ï¸ Populating dimension key cache for bulk operations...
2025-09-28 17:43:07,481 - INFO - âœ… Dimension cache populated: 263 locations, 2 vendors, 6 payment types, 6 rate codes
2025-09-28 17:43:09,380 - INFO - ğŸ“ Storing 1517 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 17:43:14,218 - WARNING - âš ï¸ Skipping 1517 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 17:43:43,658 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:43:45,583 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:44:10,373 - INFO - ğŸ“ Storing 1243 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 17:44:13,123 - WARNING - âš ï¸ Skipping 1243 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 17:44:42,317 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:44:45,444 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:45:09,301 - INFO - ğŸ“ Storing 1013 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 17:45:12,530 - WARNING - âš ï¸ Skipping 1013 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 17:45:41,415 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:45:44,582 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:46:08,320 - INFO - ğŸ“ Storing 1048 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 17:46:11,625 - WARNING - âš ï¸ Skipping 1048 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 17:46:41,557 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:46:44,764 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:47:08,353 - INFO - ğŸ“ Storing 1018 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 17:47:11,631 - WARNING - âš ï¸ Skipping 1018 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 17:47:41,635 - INFO - ğŸ“¥ yellow_tripdata_2024-09.parquet: Processed 500,000 rows - Loaded: 500,000 normalized, 494,161 star, 0 duplicates, 0 invalid (5/37 chunks)
2025-09-28 17:47:41,638 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:47:44,857 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:48:08,874 - INFO - ğŸ“ Storing 1056 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 17:48:12,287 - WARNING - âš ï¸ Skipping 1056 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 17:48:42,276 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:48:45,482 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:49:09,325 - INFO - ğŸ“ Storing 1042 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 17:49:12,642 - WARNING - âš ï¸ Skipping 1042 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 17:49:41,806 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:49:44,896 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:50:08,671 - INFO - ğŸ“ Storing 1175 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 17:50:12,409 - WARNING - âš ï¸ Skipping 1175 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 17:50:41,292 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:50:44,413 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:51:08,325 - INFO - ğŸ“ Storing 1038 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 17:51:11,636 - WARNING - âš ï¸ Skipping 1038 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 17:51:40,993 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:51:44,183 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:52:08,169 - INFO - ğŸ“ Storing 1035 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 17:52:11,456 - WARNING - âš ï¸ Skipping 1035 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 17:52:41,335 - INFO - ğŸ“¥ yellow_tripdata_2024-09.parquet: Processed 1,000,000 rows - Loaded: 1,000,000 normalized, 988,815 star, 0 duplicates, 0 invalid (10/37 chunks)
2025-09-28 17:52:41,338 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:52:44,543 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:53:08,021 - INFO - ğŸ“ Storing 1067 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 17:53:11,397 - WARNING - âš ï¸ Skipping 1067 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 17:53:41,032 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:53:44,255 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:54:08,280 - INFO - ğŸ“ Storing 1008 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 17:54:11,459 - WARNING - âš ï¸ Skipping 1008 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 17:54:40,527 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:54:43,825 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:55:07,727 - INFO - ğŸ“ Storing 1084 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 17:55:11,350 - WARNING - âš ï¸ Skipping 1084 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 17:55:41,292 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:55:43,282 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:56:08,599 - INFO - ğŸ“ Storing 1069 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 17:56:10,767 - WARNING - âš ï¸ Skipping 1069 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 17:56:40,148 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:56:43,273 - INFO - âœ… Generated 100,000 unique row hashes
