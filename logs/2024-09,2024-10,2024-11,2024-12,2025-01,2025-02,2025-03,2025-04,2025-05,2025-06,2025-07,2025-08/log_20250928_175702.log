2025-09-28 17:57:02,987 - INFO - ğŸ“ Logging to file: /sql-scripts/logs/2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08/log_20250928_175702.log
2025-09-28 17:57:02,987 - INFO - ğŸ•’ Execution started at: 2025-09-28T17:57:02.987307
2025-09-28 17:57:02,987 - INFO - âš™ï¸ Backfill configuration: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-28 17:57:02,987 - INFO - ğŸš€ Starting Complete NYC Taxi Database Initialization...
2025-09-28 17:57:02,991 - INFO - âœ… PostgreSQL is ready!
2025-09-28 17:57:02,993 - INFO - ğŸ”§ Step 1: Database Schema Creation
2025-09-28 17:57:02,994 - INFO - ğŸ—ƒï¸ Executing SQL initialization scripts...
2025-09-28 17:57:02,997 - INFO - â„¹ï¸ Superset database already exists
2025-09-28 17:57:03,000 - INFO - ğŸ“„ Found 2 SQL scripts to execute
2025-09-28 17:57:03,003 - INFO - ğŸ”§ Executing: 00-postgis-setup.sql
2025-09-28 17:57:03,007 - INFO - âœ… Completed: 00-postgis-setup.sql
2025-09-28 17:57:03,007 - INFO - ğŸ”§ Executing: 01-nyc-taxi-schema.sql
2025-09-28 17:57:03,064 - INFO - âœ… Completed: 01-nyc-taxi-schema.sql
2025-09-28 17:57:03,065 - INFO - âœ… All SQL scripts executed successfully!
2025-09-28 17:57:03,065 - INFO - ğŸ“ Step 2: Loading Taxi Zone Reference Data
2025-09-28 17:57:03,065 - INFO - ğŸ“ Loading taxi zone reference data...
2025-09-28 17:57:03,066 - INFO - ğŸ§¹ Cleaning dictionary tables for fresh data load...
2025-09-28 17:57:03,088 - INFO - âœ… Dictionary tables cleaned
2025-09-28 17:57:03,088 - INFO - ğŸ“¥ Downloading taxi zone reference data...
2025-09-28 17:57:03,088 - INFO - ğŸ“¥ Downloading taxi zone reference data...
2025-09-28 17:57:03,091 - INFO - ğŸ“¥ Downloading taxi_zone_lookup.csv...
2025-09-28 17:57:03,199 - INFO - âœ… Downloaded: taxi_zone_lookup.csv
2025-09-28 17:57:03,200 - INFO - ğŸ“¥ Downloading taxi_zones.zip...
2025-09-28 17:57:03,353 - INFO - âœ… Downloaded: taxi_zones.zip
2025-09-28 17:57:03,414 - INFO - âœ… Extracted shapefile components
2025-09-28 17:57:03,416 - INFO - ğŸ—‘ï¸ Cleaned up ZIP file
2025-09-28 17:57:03,423 - INFO - âœ… All taxi zone reference data files are available
2025-09-28 17:57:03,439 - INFO - âœ… Loaded 263 taxi zones from CSV
2025-09-28 17:57:03,441 - INFO - ğŸ—ºï¸ Loading taxi zone shapes...
2025-09-28 17:57:03,686 - INFO - âœ… Loaded 263 taxi zone shapes
2025-09-28 17:57:03,686 - INFO - ğŸ“š Reloading lookup tables...
2025-09-28 17:57:03,690 - INFO - âœ… Lookup tables reloaded
2025-09-28 17:57:03,690 - INFO - ğŸŒŸ Populating star schema dimensions...
2025-09-28 17:57:03,690 - INFO - ğŸŒŸ Starting star schema dimension population...
2025-09-28 17:57:03,691 - INFO - ğŸ“ Populating dim_locations...
2025-09-28 17:57:03,692 - INFO - ğŸš— Populating dim_vendor...
2025-09-28 17:57:03,693 - INFO - ğŸ’³ Populating dim_payment_type...
2025-09-28 17:57:03,693 - INFO - ğŸ“Š Populating dim_rate_code...
2025-09-28 17:57:03,713 - INFO - âœ… Star schema dimensions populated successfully!
2025-09-28 17:57:03,714 - INFO - ğŸš• Step 3: Loading Complete Trip Data
2025-09-28 17:57:03,714 - INFO - ğŸš• Loading trip data...
2025-09-28 17:57:03,714 - INFO - ğŸ”„ Backfill mode enabled: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-28 17:57:03,714 - INFO - ğŸ“… Backfill months: 12 months from (2024, 9) to (2025, 8)
2025-09-28 17:57:03,716 - INFO - ğŸ“… Processing 2024-09...
2025-09-28 17:57:03,717 - WARNING - âš ï¸ 2024-09: Previous processing incomplete, will retry
2025-09-28 17:57:03,724 - INFO - ğŸ“‚ File already exists: yellow_tripdata_2024-09.parquet
2025-09-28 17:57:03,727 - INFO - ğŸ“ Started processing log for 2024-09
2025-09-28 17:57:03,728 - INFO - ğŸ“¥ Loading yellow_tripdata_2024-09.parquet...
2025-09-28 17:57:04,079 - INFO - ğŸ“Š File contains 3,633,030 rows
2025-09-28 17:57:04,755 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:57:07,977 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:57:28,947 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:57:32,021 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:57:56,175 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:57:59,347 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:58:22,586 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:58:25,682 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:58:50,477 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:58:53,633 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:59:18,864 - INFO - ğŸ“¥ yellow_tripdata_2024-09.parquet: Processed 500,000 rows - Loaded: 0 normalized, 0 star, 500,000 duplicates, 0 invalid (5/37 chunks)
2025-09-28 17:59:18,864 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:59:21,970 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 17:59:45,804 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 17:59:48,943 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:00:13,340 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:00:16,625 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:00:42,327 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:00:45,429 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:01:09,218 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:01:12,390 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:01:37,386 - INFO - ğŸ“¥ yellow_tripdata_2024-09.parquet: Processed 1,000,000 rows - Loaded: 0 normalized, 0 star, 1,000,000 duplicates, 0 invalid (10/37 chunks)
2025-09-28 18:01:37,387 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:01:40,547 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:02:05,734 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:02:08,799 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:02:32,242 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:02:35,388 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:02:59,524 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:03:02,617 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:03:28,244 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:03:31,420 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:03:57,056 - INFO - ğŸ—„ï¸ Populating dimension key cache for bulk operations...
2025-09-28 18:03:57,058 - INFO - âœ… Dimension cache populated: 263 locations, 2 vendors, 6 payment types, 6 rate codes
2025-09-28 18:03:58,924 - INFO - ğŸ“ Storing 1145 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 18:04:02,538 - WARNING - âš ï¸ Skipping 1145 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 18:04:31,403 - INFO - ğŸ“¥ yellow_tripdata_2024-09.parquet: Processed 1,500,000 rows - Loaded: 100,000 normalized, 98,855 star, 1,400,000 duplicates, 0 invalid (15/37 chunks)
2025-09-28 18:04:31,406 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:04:34,463 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:04:58,041 - INFO - ğŸ“ Storing 1147 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 18:05:01,674 - WARNING - âš ï¸ Skipping 1147 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 18:05:30,702 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:05:33,749 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:05:57,834 - INFO - ğŸ“ Storing 1079 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 18:06:01,256 - WARNING - âš ï¸ Skipping 1079 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 18:06:30,012 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:06:33,069 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:06:56,679 - INFO - ğŸ“ Storing 1010 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 18:06:59,921 - WARNING - âš ï¸ Skipping 1010 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 18:07:29,104 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:07:32,226 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:07:56,309 - INFO - ğŸ“ Storing 913 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 18:07:59,249 - WARNING - âš ï¸ Skipping 913 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 18:08:28,746 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:08:31,821 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:08:55,582 - INFO - ğŸ“ Storing 1139 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 18:08:59,185 - WARNING - âš ï¸ Skipping 1139 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 18:09:28,052 - INFO - ğŸ“¥ yellow_tripdata_2024-09.parquet: Processed 2,000,000 rows - Loaded: 600,000 normalized, 593,567 star, 1,400,000 duplicates, 0 invalid (20/37 chunks)
2025-09-28 18:09:28,054 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:09:31,089 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:09:54,912 - INFO - ğŸ“ Storing 1098 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 18:09:58,390 - WARNING - âš ï¸ Skipping 1098 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 18:10:28,302 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:10:31,333 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 18:10:55,430 - INFO - ğŸ“ Storing 1017 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 18:10:58,670 - WARNING - âš ï¸ Skipping 1017 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 18:11:29,013 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 18:11:31,878 - INFO - âœ… Generated 100,000 unique row hashes
