2025-09-28 07:38:37,650 - INFO - ğŸ“ Logging to file: /sql-scripts/logs/2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08/log_20250928_073837.log
2025-09-28 07:38:37,650 - INFO - ğŸ•’ Execution started at: 2025-09-28T07:38:37.650920
2025-09-28 07:38:37,651 - INFO - âš™ï¸ Backfill configuration: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-28 07:38:37,651 - INFO - ğŸš€ Starting Complete NYC Taxi Database Initialization...
2025-09-28 07:38:37,656 - INFO - âœ… PostgreSQL is ready!
2025-09-28 07:38:37,658 - INFO - ğŸ”§ Step 1: Database Schema Creation
2025-09-28 07:38:37,659 - INFO - ğŸ—ƒï¸ Executing SQL initialization scripts...
2025-09-28 07:38:37,661 - INFO - ğŸ“„ Found 2 SQL scripts to execute
2025-09-28 07:38:37,665 - INFO - ğŸ”§ Executing: 00-postgis-setup.sql
2025-09-28 07:38:37,668 - INFO - âœ… Completed: 00-postgis-setup.sql
2025-09-28 07:38:37,668 - INFO - ğŸ”§ Executing: 01-nyc-taxi-schema.sql
2025-09-28 07:38:37,908 - INFO - âœ… Completed: 01-nyc-taxi-schema.sql
2025-09-28 07:38:37,908 - INFO - âœ… All SQL scripts executed successfully!
2025-09-28 07:38:37,908 - INFO - ğŸ“ Step 2: Loading Taxi Zone Reference Data
2025-09-28 07:38:37,909 - INFO - ğŸ“ Loading taxi zone reference data...
2025-09-28 07:38:37,909 - INFO - ğŸ§¹ Cleaning dictionary tables for fresh data load...
2025-09-28 07:38:37,934 - INFO - âœ… Dictionary tables cleaned
2025-09-28 07:38:37,934 - INFO - ğŸ“¥ Downloading taxi zone reference data...
2025-09-28 07:38:37,935 - INFO - ğŸ“¥ Downloading taxi zone reference data...
2025-09-28 07:38:37,937 - INFO - ğŸ“¥ Downloading taxi_zone_lookup.csv...
2025-09-28 07:38:38,012 - INFO - âœ… Downloaded: taxi_zone_lookup.csv
2025-09-28 07:38:38,012 - INFO - ğŸ“¥ Downloading taxi_zones.zip...
2025-09-28 07:38:38,149 - INFO - âœ… Downloaded: taxi_zones.zip
2025-09-28 07:38:38,198 - INFO - âœ… Extracted shapefile components
2025-09-28 07:38:38,200 - INFO - ğŸ—‘ï¸ Cleaned up ZIP file
2025-09-28 07:38:38,206 - INFO - âœ… All taxi zone reference data files are available
2025-09-28 07:38:38,222 - INFO - âœ… Loaded 263 taxi zones from CSV
2025-09-28 07:38:38,224 - INFO - ğŸ—ºï¸ Loading taxi zone shapes...
2025-09-28 07:38:38,480 - INFO - âœ… Loaded 263 taxi zone shapes
2025-09-28 07:38:38,481 - INFO - ğŸ“š Reloading lookup tables...
2025-09-28 07:38:38,486 - INFO - âœ… Lookup tables reloaded
2025-09-28 07:38:38,487 - INFO - ğŸŒŸ Populating star schema dimensions...
2025-09-28 07:38:38,487 - INFO - ğŸŒŸ Starting star schema dimension population...
2025-09-28 07:38:38,487 - INFO - ğŸ“ Populating dim_locations...
2025-09-28 07:38:38,489 - INFO - ğŸš— Populating dim_vendor...
2025-09-28 07:38:38,490 - INFO - ğŸ’³ Populating dim_payment_type...
2025-09-28 07:38:38,490 - INFO - ğŸ“Š Populating dim_rate_code...
2025-09-28 07:38:38,521 - INFO - âœ… Star schema dimensions populated successfully!
2025-09-28 07:38:38,522 - INFO - ğŸš• Step 3: Loading Complete Trip Data
2025-09-28 07:38:38,523 - INFO - ğŸš• Loading trip data...
2025-09-28 07:38:38,523 - INFO - ğŸ”„ Backfill mode enabled: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-28 07:38:38,523 - INFO - ğŸ“… Backfill months: 12 months from (2024, 9) to (2025, 8)
2025-09-28 07:38:38,525 - INFO - ğŸ“… Processing 2024-09...
2025-09-28 07:38:38,529 - INFO - ğŸ“¥ Downloading yellow_tripdata_2024-09.parquet from NYC TLC...
2025-09-28 07:38:39,505 - INFO - ğŸ“¥ Progress: 17.1% (10,485,760/61,170,186 bytes)
2025-09-28 07:38:40,443 - INFO - ğŸ“¥ Progress: 34.3% (20,971,520/61,170,186 bytes)
2025-09-28 07:38:41,383 - INFO - ğŸ“¥ Progress: 51.4% (31,457,280/61,170,186 bytes)
2025-09-28 07:38:42,325 - INFO - ğŸ“¥ Progress: 68.6% (41,943,040/61,170,186 bytes)
2025-09-28 07:38:43,267 - INFO - ğŸ“¥ Progress: 85.7% (52,428,800/61,170,186 bytes)
2025-09-28 07:38:44,054 - INFO - âœ… Downloaded: yellow_tripdata_2024-09.parquet (61,170,186 bytes)
2025-09-28 07:38:44,058 - INFO - ğŸ“ Started processing log for 2024-09
2025-09-28 07:38:44,059 - INFO - ğŸ“¥ Loading yellow_tripdata_2024-09.parquet...
2025-09-28 07:38:44,448 - INFO - ğŸ“Š File contains 3,633,030 rows
2025-09-28 07:38:45,034 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 07:38:48,333 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 07:39:10,902 - INFO - ğŸ—„ï¸ Populating dimension key cache for bulk operations...
2025-09-28 07:39:10,905 - INFO - âœ… Dimension cache populated: 263 locations, 2 vendors, 6 payment types, 6 rate codes
2025-09-28 07:39:12,976 - INFO - ğŸ“ Storing 1517 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 07:39:17,892 - WARNING - âš ï¸ Skipping 1517 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 07:39:46,657 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 07:39:49,751 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 07:40:12,698 - INFO - ğŸ“ Storing 1243 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 07:40:16,739 - WARNING - âš ï¸ Skipping 1243 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 07:40:45,260 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 07:40:48,311 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 07:41:12,383 - INFO - ğŸ“ Storing 1013 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 07:41:15,735 - WARNING - âš ï¸ Skipping 1013 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 07:41:44,932 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 07:41:48,032 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 07:42:12,073 - INFO - ğŸ“ Storing 1048 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 07:42:15,498 - WARNING - âš ï¸ Skipping 1048 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 07:42:44,645 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 07:42:45,961 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 07:43:11,161 - INFO - ğŸ“ Storing 1018 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 07:43:14,484 - WARNING - âš ï¸ Skipping 1018 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 07:43:41,488 - INFO - ğŸ“¥ yellow_tripdata_2024-09.parquet: Processed 500,000 rows - Loaded: 500,000 normalized, 494,161 star, 0 duplicates, 0 invalid (5/37 chunks)
2025-09-28 07:43:41,491 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 07:43:44,613 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 07:44:09,182 - INFO - ğŸ“ Storing 1056 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 07:44:11,025 - WARNING - âš ï¸ Skipping 1056 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 07:44:39,425 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 07:44:42,478 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 07:45:07,244 - INFO - ğŸ“ Storing 1042 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 07:45:08,890 - WARNING - âš ï¸ Skipping 1042 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 07:45:36,687 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 07:45:39,774 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 07:46:03,039 - INFO - ğŸ“ Storing 1175 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 07:46:06,806 - WARNING - âš ï¸ Skipping 1175 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 07:46:34,183 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 07:46:37,227 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 07:47:00,520 - INFO - ğŸ“ Storing 1038 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 07:47:03,868 - WARNING - âš ï¸ Skipping 1038 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 07:47:31,292 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 07:47:34,421 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 07:47:59,078 - INFO - ğŸ“ Storing 1035 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 07:48:02,516 - WARNING - âš ï¸ Skipping 1035 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 07:48:29,727 - INFO - ğŸ“¥ yellow_tripdata_2024-09.parquet: Processed 1,000,000 rows - Loaded: 1,000,000 normalized, 988,815 star, 0 duplicates, 0 invalid (10/37 chunks)
2025-09-28 07:48:29,730 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 07:48:32,815 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 07:48:55,628 - INFO - ğŸ“ Storing 1067 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 07:48:59,131 - WARNING - âš ï¸ Skipping 1067 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 07:49:26,839 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 07:49:29,917 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 07:49:53,127 - INFO - ğŸ“ Storing 1008 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 07:49:56,380 - WARNING - âš ï¸ Skipping 1008 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 07:50:23,820 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 07:50:26,920 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 07:50:49,989 - INFO - ğŸ“ Storing 1084 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 07:50:53,517 - WARNING - âš ï¸ Skipping 1084 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 07:51:21,053 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 07:51:24,082 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 07:51:47,684 - INFO - ğŸ“ Storing 1069 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 07:51:51,110 - WARNING - âš ï¸ Skipping 1069 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 07:52:18,922 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 07:52:21,963 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 07:52:45,321 - INFO - ğŸ“ Storing 1145 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 07:52:49,032 - WARNING - âš ï¸ Skipping 1145 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 07:53:16,968 - INFO - ğŸ“¥ yellow_tripdata_2024-09.parquet: Processed 1,500,000 rows - Loaded: 1,500,000 normalized, 1,483,442 star, 0 duplicates, 0 invalid (15/37 chunks)
2025-09-28 07:53:16,971 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 07:53:20,095 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 07:53:43,606 - INFO - ğŸ“ Storing 1147 invalid rows in yellow_taxi_trips_invalid table
2025-09-28 07:53:47,349 - WARNING - âš ï¸ Skipping 1147 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-28 07:54:15,268 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-28 07:54:18,353 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-28 07:54:41,378 - INFO - ğŸ“ Storing 1079 invalid rows in yellow_taxi_trips_invalid table
