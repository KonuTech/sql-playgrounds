2025-09-29 11:05:18,497 - INFO - ğŸ“ Logging to file: /sql-scripts/logs/2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08/log_20250929_110518.log
2025-09-29 11:05:18,497 - INFO - ğŸ•’ Execution started at: 2025-09-29T11:05:18.497574
2025-09-29 11:05:18,497 - INFO - âš™ï¸ Backfill configuration: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-29 11:05:18,498 - INFO - ğŸš€ Starting Complete NYC Taxi Database Initialization...
2025-09-29 11:05:18,506 - INFO - âœ… PostgreSQL is ready!
2025-09-29 11:05:18,509 - INFO - ğŸ”§ Step 1: Database Schema Creation
2025-09-29 11:05:18,509 - INFO - ğŸ—ƒï¸ Executing SQL initialization scripts...
2025-09-29 11:05:18,524 - INFO - â„¹ï¸ Superset database already exists
2025-09-29 11:05:18,527 - INFO - ğŸ“„ Found 2 SQL scripts to execute
2025-09-29 11:05:18,537 - INFO - ğŸ”§ Executing: 00-postgis-setup.sql
2025-09-29 11:05:18,553 - INFO - âœ… Completed: 00-postgis-setup.sql
2025-09-29 11:05:18,554 - INFO - ğŸ”§ Executing: 01-nyc-taxi-schema.sql
2025-09-29 11:05:18,647 - INFO - âœ… Completed: 01-nyc-taxi-schema.sql
2025-09-29 11:05:18,648 - INFO - âœ… All SQL scripts executed successfully!
2025-09-29 11:05:18,648 - INFO - ğŸ“ Step 2: Loading Taxi Zone Reference Data
2025-09-29 11:05:18,648 - INFO - ğŸ“ Loading taxi zone reference data...
2025-09-29 11:05:18,648 - INFO - ğŸ§¹ Cleaning dictionary tables for fresh data load...
2025-09-29 11:05:18,702 - INFO - âœ… Dictionary tables cleaned
2025-09-29 11:05:18,702 - INFO - ğŸ“¥ Downloading taxi zone reference data...
2025-09-29 11:05:18,703 - INFO - ğŸ“¥ Downloading taxi zone reference data...
2025-09-29 11:05:18,706 - INFO - ğŸ“¥ Downloading taxi_zone_lookup.csv...
2025-09-29 11:05:18,783 - INFO - âœ… Downloaded: taxi_zone_lookup.csv
2025-09-29 11:05:18,783 - INFO - ğŸ“¥ Downloading taxi_zones.zip...
2025-09-29 11:05:18,930 - INFO - âœ… Downloaded: taxi_zones.zip
2025-09-29 11:05:19,009 - INFO - âœ… Extracted shapefile components
2025-09-29 11:05:19,011 - INFO - ğŸ—‘ï¸ Cleaned up ZIP file
2025-09-29 11:05:19,017 - INFO - âœ… All taxi zone reference data files are available
2025-09-29 11:05:19,041 - INFO - âœ… Loaded 263 taxi zones from CSV
2025-09-29 11:05:19,042 - INFO - ğŸ—ºï¸ Loading taxi zone shapes...
2025-09-29 11:05:19,445 - INFO - âœ… Loaded 263 taxi zone shapes
2025-09-29 11:05:19,445 - INFO - ğŸ“š Reloading lookup tables...
2025-09-29 11:05:19,449 - INFO - âœ… Lookup tables reloaded
2025-09-29 11:05:19,449 - INFO - ğŸŒŸ Populating star schema dimensions...
2025-09-29 11:05:19,450 - INFO - ğŸŒŸ Starting star schema dimension population...
2025-09-29 11:05:19,450 - INFO - ğŸ“ Populating dim_locations...
2025-09-29 11:05:19,452 - INFO - ğŸš— Populating dim_vendor...
2025-09-29 11:05:19,454 - INFO - ğŸ’³ Populating dim_payment_type...
2025-09-29 11:05:19,455 - INFO - ğŸ“Š Populating dim_rate_code...
2025-09-29 11:05:19,475 - INFO - âœ… Star schema dimensions populated successfully!
2025-09-29 11:05:19,476 - INFO - ğŸš• Step 3: Loading Complete Trip Data
2025-09-29 11:05:19,476 - INFO - ğŸš• Loading trip data...
2025-09-29 11:05:19,477 - INFO - ğŸ”„ Backfill mode enabled: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-29 11:05:19,477 - INFO - ğŸ“… Backfill months: 12 months from (2024, 9) to (2025, 8)
2025-09-29 11:05:19,478 - INFO - ğŸ“… Processing 2024-09...
2025-09-29 11:05:19,480 - INFO - ğŸ”„ 2024-09: Already processed (3,633,030 records at 2025-09-29 07:50:00.025521)
2025-09-29 11:05:19,480 - INFO - ğŸ“… Processing 2024-10...
2025-09-29 11:05:19,481 - INFO - ğŸ”„ 2024-10: Already processed (3,833,769 records at 2025-09-29 08:28:52.271100)
2025-09-29 11:05:19,481 - INFO - ğŸ“… Processing 2024-11...
2025-09-29 11:05:19,482 - INFO - ğŸ”„ 2024-11: Already processed (3,646,369 records at 2025-09-29 09:09:25.017380)
2025-09-29 11:05:19,482 - INFO - ğŸ“… Processing 2024-12...
2025-09-29 11:05:19,483 - INFO - ğŸ”„ 2024-12: Already processed (3,668,371 records at 2025-09-29 09:46:19.020129)
2025-09-29 11:05:19,483 - INFO - ğŸ“… Processing 2025-01...
2025-09-29 11:05:19,483 - INFO - ğŸ”„ 2025-01: Already processed (3,475,226 records at 2025-09-29 10:20:45.118816)
2025-09-29 11:05:19,484 - INFO - ğŸ“… Processing 2025-02...
2025-09-29 11:05:19,484 - INFO - ğŸ”„ 2025-02: Already processed (3,577,543 records at 2025-09-29 10:55:55.916185)
2025-09-29 11:05:19,485 - INFO - ğŸ“… Processing 2025-03...
2025-09-29 11:05:19,485 - WARNING - âš ï¸ 2025-03: Previous processing incomplete, will retry
2025-09-29 11:05:19,492 - INFO - ğŸ“‚ File already exists: yellow_tripdata_2025-03.parquet
2025-09-29 11:05:19,496 - INFO - ğŸ“ Started processing log for 2025-03
2025-09-29 11:05:19,496 - INFO - ğŸ“¥ Loading yellow_tripdata_2025-03.parquet...
2025-09-29 11:05:20,061 - INFO - ğŸ“Š File contains 4,145,257 rows
2025-09-29 11:05:20,865 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 11:05:24,243 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 11:05:44,161 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 11:05:47,348 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 11:06:12,487 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 11:06:13,386 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 11:06:37,860 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 11:06:38,772 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 11:07:04,396 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 11:07:07,576 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 11:07:32,447 - INFO - ğŸ“¥ yellow_tripdata_2025-03.parquet: Processed 500,000 rows - Loaded: 0 normalized, 0 star, 500,000 duplicates, 0 invalid (5/42 chunks)
2025-09-29 11:07:32,448 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 11:07:35,835 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 11:07:59,166 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 11:08:02,407 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 11:08:26,022 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 11:08:29,241 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 11:08:54,698 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 11:08:57,890 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 11:09:21,199 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 11:09:24,475 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 11:09:51,180 - INFO - ğŸ—„ï¸ Populating dimension key cache for bulk operations...
2025-09-29 11:09:51,182 - INFO - âœ… Dimension cache populated: 263 locations, 2 vendors, 6 payment types, 6 rate codes
2025-09-29 11:09:53,126 - INFO - ğŸ“ Storing 939 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 11:09:53,987 - WARNING - âš ï¸ Skipping 939 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
