2025-09-29 11:52:16,992 - INFO - 📝 Logging to file: /sql-scripts/logs/2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08/log_20250929_115216.log
2025-09-29 11:52:16,993 - INFO - 🕒 Execution started at: 2025-09-29T11:52:16.993041
2025-09-29 11:52:16,993 - INFO - ⚙️ Backfill configuration: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-29 11:52:16,993 - INFO - 🚀 Starting Complete NYC Taxi Database Initialization...
2025-09-29 11:52:16,998 - INFO - ✅ PostgreSQL is ready!
2025-09-29 11:52:17,001 - INFO - 🔧 Step 1: Database Schema Creation
2025-09-29 11:52:17,001 - INFO - 🗃️ Executing SQL initialization scripts...
2025-09-29 11:52:17,005 - INFO - ℹ️ Superset database already exists
2025-09-29 11:52:17,007 - INFO - 📄 Found 2 SQL scripts to execute
2025-09-29 11:52:17,012 - INFO - 🔧 Executing: 00-postgis-setup.sql
2025-09-29 11:52:17,015 - INFO - ✅ Completed: 00-postgis-setup.sql
2025-09-29 11:52:17,015 - INFO - 🔧 Executing: 01-nyc-taxi-schema.sql
2025-09-29 11:52:17,082 - INFO - ✅ Completed: 01-nyc-taxi-schema.sql
2025-09-29 11:52:17,082 - INFO - ✅ All SQL scripts executed successfully!
2025-09-29 11:52:17,083 - INFO - 📍 Step 2: Loading Taxi Zone Reference Data
2025-09-29 11:52:17,083 - INFO - 📍 Loading taxi zone reference data...
2025-09-29 11:52:17,083 - INFO - 🧹 Cleaning dictionary tables for fresh data load...
2025-09-29 11:52:17,112 - INFO - ✅ Dictionary tables cleaned
2025-09-29 11:52:17,112 - INFO - 📥 Downloading taxi zone reference data...
2025-09-29 11:52:17,112 - INFO - 📥 Downloading taxi zone reference data...
2025-09-29 11:52:17,115 - INFO - 📥 Downloading taxi_zone_lookup.csv...
2025-09-29 11:52:17,259 - INFO - ✅ Downloaded: taxi_zone_lookup.csv
2025-09-29 11:52:17,260 - INFO - 📥 Downloading taxi_zones.zip...
2025-09-29 11:52:17,404 - INFO - ✅ Downloaded: taxi_zones.zip
2025-09-29 11:52:17,466 - INFO - ✅ Extracted shapefile components
2025-09-29 11:52:17,469 - INFO - 🗑️ Cleaned up ZIP file
2025-09-29 11:52:17,477 - INFO - ✅ All taxi zone reference data files are available
2025-09-29 11:52:17,498 - INFO - ✅ Loaded 263 taxi zones from CSV
2025-09-29 11:52:17,500 - INFO - 🗺️ Loading taxi zone shapes...
2025-09-29 11:52:17,772 - INFO - ✅ Loaded 263 taxi zone shapes
2025-09-29 11:52:17,772 - INFO - 📚 Reloading lookup tables...
2025-09-29 11:52:17,776 - INFO - ✅ Lookup tables reloaded
2025-09-29 11:52:17,776 - INFO - 🌟 Populating star schema dimensions...
2025-09-29 11:52:17,777 - INFO - 🌟 Starting star schema dimension population...
2025-09-29 11:52:17,777 - INFO - 📍 Populating dim_locations...
2025-09-29 11:52:17,779 - INFO - 🚗 Populating dim_vendor...
2025-09-29 11:52:17,779 - INFO - 💳 Populating dim_payment_type...
2025-09-29 11:52:17,780 - INFO - 📊 Populating dim_rate_code...
2025-09-29 11:52:17,801 - INFO - ✅ Star schema dimensions populated successfully!
2025-09-29 11:52:17,802 - INFO - 🚕 Step 3: Loading Complete Trip Data
2025-09-29 11:52:17,802 - INFO - 🚕 Loading trip data...
2025-09-29 11:52:17,802 - INFO - 🔄 Backfill mode enabled: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-29 11:52:17,803 - INFO - 📅 Backfill months: 12 months from (2024, 9) to (2025, 8)
2025-09-29 11:52:17,804 - INFO - 📅 Processing 2024-09...
2025-09-29 11:52:17,805 - WARNING - ⚠️ 2024-09: Previous processing incomplete, will retry
2025-09-29 11:52:17,813 - INFO - 📂 File already exists: yellow_tripdata_2024-09.parquet
2025-09-29 11:52:17,816 - INFO - 📝 Started processing log for 2024-09
2025-09-29 11:52:17,816 - INFO - 📥 Loading yellow_tripdata_2024-09.parquet...
2025-09-29 11:52:18,285 - INFO - 📊 File contains 3,633,030 rows
2025-09-29 11:52:18,927 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 11:52:23,006 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 11:52:43,830 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 11:52:47,008 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 11:53:10,057 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 11:53:13,247 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 11:53:35,563 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 11:53:38,750 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 11:54:01,923 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 11:54:05,067 - INFO - ✅ Generated 100,000 unique row hashes
