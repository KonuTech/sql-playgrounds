2025-09-29 07:14:27,729 - INFO - ğŸ“ Logging to file: /sql-scripts/logs/2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08/log_20250929_071427.log
2025-09-29 07:14:27,729 - INFO - ğŸ•’ Execution started at: 2025-09-29T07:14:27.729690
2025-09-29 07:14:27,729 - INFO - âš™ï¸ Backfill configuration: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-29 07:14:27,730 - INFO - ğŸš€ Starting Complete NYC Taxi Database Initialization...
2025-09-29 07:14:27,734 - INFO - âœ… PostgreSQL is ready!
2025-09-29 07:14:27,737 - INFO - ğŸ”§ Step 1: Database Schema Creation
2025-09-29 07:14:27,738 - INFO - ğŸ—ƒï¸ Executing SQL initialization scripts...
2025-09-29 07:14:27,742 - INFO - ğŸ”§ Creating superset database...
2025-09-29 07:14:27,810 - INFO - âœ… Superset database created successfully
2025-09-29 07:14:27,814 - INFO - ğŸ“„ Found 2 SQL scripts to execute
2025-09-29 07:14:27,819 - INFO - ğŸ”§ Executing: 00-postgis-setup.sql
2025-09-29 07:14:27,824 - INFO - âœ… Completed: 00-postgis-setup.sql
2025-09-29 07:14:27,824 - INFO - ğŸ”§ Executing: 01-nyc-taxi-schema.sql
2025-09-29 07:14:28,090 - INFO - âœ… Completed: 01-nyc-taxi-schema.sql
2025-09-29 07:14:28,091 - INFO - âœ… All SQL scripts executed successfully!
2025-09-29 07:14:28,091 - INFO - ğŸ“ Step 2: Loading Taxi Zone Reference Data
2025-09-29 07:14:28,091 - INFO - ğŸ“ Loading taxi zone reference data...
2025-09-29 07:14:28,091 - INFO - ğŸ§¹ Cleaning dictionary tables for fresh data load...
2025-09-29 07:14:28,120 - INFO - âœ… Dictionary tables cleaned
2025-09-29 07:14:28,121 - INFO - ğŸ“¥ Downloading taxi zone reference data...
2025-09-29 07:14:28,121 - INFO - ğŸ“¥ Downloading taxi zone reference data...
2025-09-29 07:14:28,124 - INFO - ğŸ“¥ Downloading taxi_zone_lookup.csv...
2025-09-29 07:14:28,236 - INFO - âœ… Downloaded: taxi_zone_lookup.csv
2025-09-29 07:14:28,237 - INFO - ğŸ“¥ Downloading taxi_zones.zip...
2025-09-29 07:14:28,378 - INFO - âœ… Downloaded: taxi_zones.zip
2025-09-29 07:14:28,428 - INFO - âœ… Extracted shapefile components
2025-09-29 07:14:28,431 - INFO - ğŸ—‘ï¸ Cleaned up ZIP file
2025-09-29 07:14:28,437 - INFO - âœ… All taxi zone reference data files are available
2025-09-29 07:14:28,454 - INFO - âœ… Loaded 263 taxi zones from CSV
2025-09-29 07:14:28,456 - INFO - ğŸ—ºï¸ Loading taxi zone shapes...
2025-09-29 07:14:28,708 - INFO - âœ… Loaded 263 taxi zone shapes
2025-09-29 07:14:28,708 - INFO - ğŸ“š Reloading lookup tables...
2025-09-29 07:14:28,713 - INFO - âœ… Lookup tables reloaded
2025-09-29 07:14:28,713 - INFO - ğŸŒŸ Populating star schema dimensions...
2025-09-29 07:14:28,714 - INFO - ğŸŒŸ Starting star schema dimension population...
2025-09-29 07:14:28,714 - INFO - ğŸ“ Populating dim_locations...
2025-09-29 07:14:28,716 - INFO - ğŸš— Populating dim_vendor...
2025-09-29 07:14:28,717 - INFO - ğŸ’³ Populating dim_payment_type...
2025-09-29 07:14:28,717 - INFO - ğŸ“Š Populating dim_rate_code...
2025-09-29 07:14:28,746 - INFO - âœ… Star schema dimensions populated successfully!
2025-09-29 07:14:28,747 - INFO - ğŸš• Step 3: Loading Complete Trip Data
2025-09-29 07:14:28,748 - INFO - ğŸš• Loading trip data...
2025-09-29 07:14:28,748 - INFO - ğŸ”„ Backfill mode enabled: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-29 07:14:28,748 - INFO - ğŸ“… Backfill months: 12 months from (2024, 9) to (2025, 8)
2025-09-29 07:14:28,750 - INFO - ğŸ“… Processing 2024-09...
2025-09-29 07:14:28,756 - INFO - ğŸ“‚ File already exists: yellow_tripdata_2024-09.parquet
2025-09-29 07:14:28,762 - INFO - ğŸ“ Started processing log for 2024-09
2025-09-29 07:14:28,762 - INFO - ğŸ“¥ Loading yellow_tripdata_2024-09.parquet...
2025-09-29 07:14:29,199 - INFO - ğŸ“Š File contains 3,633,030 rows
2025-09-29 07:14:29,808 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 07:14:33,113 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 07:14:56,118 - INFO - ğŸ—„ï¸ Populating dimension key cache for bulk operations...
2025-09-29 07:14:56,120 - INFO - âœ… Dimension cache populated: 263 locations, 2 vendors, 6 payment types, 6 rate codes
2025-09-29 07:14:58,052 - INFO - ğŸ“ Storing 1517 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 07:15:03,036 - WARNING - âš ï¸ Skipping 1517 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 07:15:32,743 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 07:15:35,921 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 07:15:59,314 - INFO - ğŸ“ Storing 1243 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 07:16:03,484 - WARNING - âš ï¸ Skipping 1243 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 07:16:32,564 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 07:16:35,777 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 07:16:59,663 - INFO - ğŸ“ Storing 1013 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 07:17:03,015 - WARNING - âš ï¸ Skipping 1013 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 07:17:31,919 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 07:17:35,209 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 07:17:58,537 - INFO - ğŸ“ Storing 1048 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 07:18:02,051 - WARNING - âš ï¸ Skipping 1048 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 07:18:31,208 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 07:18:32,114 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 07:18:57,979 - INFO - ğŸ“ Storing 1018 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 07:19:01,361 - WARNING - âš ï¸ Skipping 1018 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 07:19:27,664 - INFO - ğŸ“¥ yellow_tripdata_2024-09.parquet: Processed 500,000 rows - Loaded: 500,000 normalized, 494,161 star, 0 duplicates, 0 invalid (5/37 chunks)
2025-09-29 07:19:27,667 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 07:19:30,956 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 07:19:56,440 - INFO - ğŸ“ Storing 1056 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 07:19:57,666 - WARNING - âš ï¸ Skipping 1056 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 07:20:27,374 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 07:20:30,535 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 07:20:54,119 - INFO - ğŸ“ Storing 1042 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 07:20:57,551 - WARNING - âš ï¸ Skipping 1042 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 07:21:26,171 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 07:21:29,370 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 07:21:52,675 - INFO - ğŸ“ Storing 1175 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 07:21:56,792 - WARNING - âš ï¸ Skipping 1175 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 07:22:24,968 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 07:22:28,119 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 07:22:51,470 - INFO - ğŸ“ Storing 1038 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 07:22:54,868 - WARNING - âš ï¸ Skipping 1038 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 07:23:23,384 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 07:23:26,571 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 07:23:50,160 - INFO - ğŸ“ Storing 1035 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 07:23:53,569 - WARNING - âš ï¸ Skipping 1035 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 07:24:22,561 - INFO - ğŸ“¥ yellow_tripdata_2024-09.parquet: Processed 1,000,000 rows - Loaded: 1,000,000 normalized, 988,815 star, 0 duplicates, 0 invalid (10/37 chunks)
2025-09-29 07:24:22,563 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 07:24:25,773 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 07:24:49,201 - INFO - ğŸ“ Storing 1067 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 07:24:52,709 - WARNING - âš ï¸ Skipping 1067 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 07:25:21,637 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 07:25:24,841 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 07:25:48,324 - INFO - ğŸ“ Storing 1008 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 07:25:51,680 - WARNING - âš ï¸ Skipping 1008 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
