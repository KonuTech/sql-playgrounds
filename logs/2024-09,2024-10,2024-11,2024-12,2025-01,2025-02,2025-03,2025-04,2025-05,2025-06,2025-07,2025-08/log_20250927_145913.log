2025-09-27 14:59:13,740 - INFO - 📝 Logging to file: /sql-scripts/logs/2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08/log_20250927_145913.log
2025-09-27 14:59:13,741 - INFO - 🕒 Execution started at: 2025-09-27T14:59:13.741223
2025-09-27 14:59:13,741 - INFO - ⚙️ Backfill configuration: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-27 14:59:13,741 - INFO - 🚀 Starting Complete NYC Taxi Database Initialization...
2025-09-27 14:59:13,746 - INFO - ✅ PostgreSQL is ready!
2025-09-27 14:59:13,749 - INFO - 🔧 Step 1: Database Schema Creation
2025-09-27 14:59:13,749 - INFO - 🗃️ Executing SQL initialization scripts...
2025-09-27 14:59:13,751 - INFO - 📄 Found 2 SQL scripts to execute
2025-09-27 14:59:13,755 - INFO - 🔧 Executing: 00-postgis-setup.sql
2025-09-27 14:59:13,758 - INFO - ✅ Completed: 00-postgis-setup.sql
2025-09-27 14:59:13,759 - INFO - 🔧 Executing: 01-nyc-taxi-schema.sql
2025-09-27 14:59:14,036 - INFO - ✅ Completed: 01-nyc-taxi-schema.sql
2025-09-27 14:59:14,036 - INFO - ✅ All SQL scripts executed successfully!
2025-09-27 14:59:14,037 - INFO - 📍 Step 2: Loading Taxi Zone Reference Data
2025-09-27 14:59:14,037 - INFO - 📍 Loading taxi zone reference data...
2025-09-27 14:59:14,037 - INFO - 🧹 Cleaning dictionary tables for fresh data load...
2025-09-27 14:59:14,059 - INFO - ✅ Dictionary tables cleaned
2025-09-27 14:59:14,060 - INFO - 📥 Downloading taxi zone reference data...
2025-09-27 14:59:14,060 - INFO - 📥 Downloading taxi zone reference data...
2025-09-27 14:59:14,062 - INFO - 📥 Downloading taxi_zone_lookup.csv...
2025-09-27 14:59:14,160 - INFO - ✅ Downloaded: taxi_zone_lookup.csv
2025-09-27 14:59:14,160 - INFO - 📥 Downloading taxi_zones.zip...
2025-09-27 14:59:14,636 - INFO - ✅ Downloaded: taxi_zones.zip
2025-09-27 14:59:14,685 - INFO - ✅ Extracted shapefile components
2025-09-27 14:59:14,687 - INFO - 🗑️ Cleaned up ZIP file
2025-09-27 14:59:14,692 - INFO - ✅ All taxi zone reference data files are available
2025-09-27 14:59:14,710 - INFO - ✅ Loaded 263 taxi zones from CSV
2025-09-27 14:59:14,711 - INFO - 🗺️ Loading taxi zone shapes...
2025-09-27 14:59:14,959 - INFO - ✅ Loaded 263 taxi zone shapes
2025-09-27 14:59:14,959 - INFO - 📚 Reloading lookup tables...
2025-09-27 14:59:14,967 - INFO - ✅ Lookup tables reloaded
2025-09-27 14:59:14,968 - INFO - 🌟 Populating star schema dimensions...
2025-09-27 14:59:14,968 - INFO - 🌟 Starting star schema dimension population...
2025-09-27 14:59:14,968 - INFO - 📍 Populating dim_locations...
2025-09-27 14:59:14,970 - INFO - 🚗 Populating dim_vendor...
2025-09-27 14:59:14,971 - INFO - 💳 Populating dim_payment_type...
2025-09-27 14:59:14,971 - INFO - 📊 Populating dim_rate_code...
2025-09-27 14:59:14,998 - INFO - ✅ Star schema dimensions populated successfully!
2025-09-27 14:59:14,999 - INFO - 🚕 Step 3: Loading Complete Trip Data
2025-09-27 14:59:14,999 - INFO - 🚕 Loading trip data...
2025-09-27 14:59:14,999 - INFO - 🔄 Backfill mode enabled: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-27 14:59:14,999 - INFO - 📅 Backfill months: 12 months from (2024, 9) to (2025, 8)
2025-09-27 14:59:15,001 - INFO - 📅 Processing 2024-09...
2025-09-27 14:59:15,005 - INFO - 📥 Downloading yellow_tripdata_2024-09.parquet from NYC TLC...
2025-09-27 14:59:16,047 - INFO - 📥 Progress: 17.1% (10,485,760/61,170,186 bytes)
2025-09-27 14:59:17,061 - INFO - 📥 Progress: 34.3% (20,971,520/61,170,186 bytes)
2025-09-27 14:59:18,063 - INFO - 📥 Progress: 51.4% (31,457,280/61,170,186 bytes)
2025-09-27 14:59:19,061 - INFO - 📥 Progress: 68.6% (41,943,040/61,170,186 bytes)
2025-09-27 14:59:20,065 - INFO - 📥 Progress: 85.7% (52,428,800/61,170,186 bytes)
2025-09-27 14:59:20,900 - INFO - ✅ Downloaded: yellow_tripdata_2024-09.parquet (61,170,186 bytes)
2025-09-27 14:59:20,905 - INFO - 📝 Started processing log for 2024-09
2025-09-27 14:59:20,905 - INFO - 📥 Loading yellow_tripdata_2024-09.parquet...
2025-09-27 14:59:21,304 - INFO - 📊 File contains 3,633,030 rows
2025-09-27 14:59:21,895 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 14:59:22,066 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 14:59:55,795 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 14:59:55,964 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:00:29,382 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:00:29,554 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:01:01,925 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:01:02,106 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:01:36,033 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:01:36,202 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:02:10,037 - INFO - 📥 yellow_tripdata_2024-09.parquet: Processed 50,000 rows - Loaded: 50,000 normalized, 50,000 star, 0 duplicates, 0 invalid (5/364 chunks)
2025-09-27 15:02:10,037 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:02:10,204 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:02:44,127 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:02:44,316 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:03:17,988 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:03:18,154 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:03:51,743 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:03:51,914 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:04:24,861 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:04:25,048 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:04:58,627 - INFO - 📥 yellow_tripdata_2024-09.parquet: Processed 100,000 rows - Loaded: 100,000 normalized, 100,000 star, 0 duplicates, 0 invalid (10/364 chunks)
2025-09-27 15:04:58,628 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:04:58,793 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:05:32,786 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:05:32,953 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:06:07,015 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:06:07,220 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:06:41,499 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:06:41,667 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:07:15,666 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:07:15,836 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:07:48,675 - INFO - 📥 yellow_tripdata_2024-09.parquet: Processed 150,000 rows - Loaded: 150,000 normalized, 150,000 star, 0 duplicates, 0 invalid (15/364 chunks)
2025-09-27 15:07:48,675 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:07:48,846 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:08:22,995 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:08:23,165 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:08:57,835 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:08:58,032 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:09:32,085 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:09:32,256 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:10:06,170 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:10:06,338 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:10:40,093 - INFO - 📥 yellow_tripdata_2024-09.parquet: Processed 200,000 rows - Loaded: 200,000 normalized, 200,000 star, 0 duplicates, 0 invalid (20/364 chunks)
2025-09-27 15:10:40,094 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:10:40,262 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:11:13,052 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:11:13,220 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:11:47,251 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:11:47,420 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:12:21,202 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:12:21,374 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:12:55,342 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:12:55,512 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:13:29,727 - INFO - 📥 yellow_tripdata_2024-09.parquet: Processed 250,000 rows - Loaded: 250,000 normalized, 250,000 star, 0 duplicates, 0 invalid (25/364 chunks)
2025-09-27 15:13:29,728 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:13:29,904 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:14:03,922 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:14:04,095 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:14:36,714 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:14:36,886 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:15:10,639 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:15:10,826 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:15:44,513 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:15:44,695 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:16:18,504 - INFO - 📥 yellow_tripdata_2024-09.parquet: Processed 300,000 rows - Loaded: 300,000 normalized, 300,000 star, 0 duplicates, 0 invalid (30/364 chunks)
2025-09-27 15:16:18,505 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:16:18,676 - INFO - ✅ Generated 10,000 unique row hashes
2025-09-27 15:16:52,518 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-27 15:16:52,690 - INFO - ✅ Generated 10,000 unique row hashes
