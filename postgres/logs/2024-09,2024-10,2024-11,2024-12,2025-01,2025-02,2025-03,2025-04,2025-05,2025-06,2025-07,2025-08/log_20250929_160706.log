2025-09-29 16:07:06,695 - INFO - 📝 Logging to file: /postgres/logs/2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08/log_20250929_160706.log
2025-09-29 16:07:06,695 - INFO - 🕒 Execution started at: 2025-09-29T16:07:06.695818
2025-09-29 16:07:06,696 - INFO - ⚙️ Backfill configuration: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-29 16:07:06,696 - INFO - 🚀 Starting Complete NYC Taxi Database Initialization...
2025-09-29 16:07:06,704 - INFO - ✅ PostgreSQL is ready!
2025-09-29 16:07:06,707 - INFO - 🔧 Step 1: Database Schema Creation
2025-09-29 16:07:06,707 - INFO - 🗃️ Executing SQL initialization scripts...
2025-09-29 16:07:06,710 - INFO - 📄 Found 2 SQL scripts to execute
2025-09-29 16:07:06,718 - INFO - 🔧 Executing: 00-postgis-setup.sql
2025-09-29 16:07:06,756 - INFO - ✅ Completed: 00-postgis-setup.sql
2025-09-29 16:07:06,760 - INFO - 🔧 Executing: 01-nyc-taxi-schema.sql
2025-09-29 16:07:06,892 - INFO - ✅ Completed: 01-nyc-taxi-schema.sql
2025-09-29 16:07:06,893 - INFO - ✅ All SQL scripts executed successfully!
2025-09-29 16:07:06,893 - INFO - 📍 Step 2: Loading Taxi Zone Reference Data
2025-09-29 16:07:06,893 - INFO - 📍 Loading taxi zone reference data...
2025-09-29 16:07:06,894 - INFO - 🧹 Cleaning dictionary tables for fresh data load...
2025-09-29 16:07:06,941 - INFO - ✅ Dictionary tables cleaned
2025-09-29 16:07:06,941 - INFO - 📥 Downloading taxi zone reference data...
2025-09-29 16:07:06,942 - INFO - 📥 Downloading taxi zone reference data...
2025-09-29 16:07:06,943 - INFO - 📥 Downloading taxi_zone_lookup.csv...
2025-09-29 16:07:07,393 - INFO - ✅ Downloaded: taxi_zone_lookup.csv
2025-09-29 16:07:07,393 - INFO - 📥 Downloading taxi_zones.zip...
2025-09-29 16:07:07,541 - INFO - ✅ Downloaded: taxi_zones.zip
2025-09-29 16:07:07,630 - INFO - ✅ Extracted shapefile components
2025-09-29 16:07:07,632 - INFO - 🗑️ Cleaned up ZIP file
2025-09-29 16:07:07,636 - INFO - ✅ All taxi zone reference data files are available
2025-09-29 16:07:07,657 - INFO - ✅ Loaded 263 taxi zones from CSV
2025-09-29 16:07:07,659 - INFO - 🗺️ Loading taxi zone shapes...
2025-09-29 16:07:08,055 - INFO - ✅ Loaded 263 taxi zone shapes
2025-09-29 16:07:08,055 - INFO - 📚 Reloading lookup tables...
2025-09-29 16:07:08,060 - INFO - ✅ Lookup tables reloaded
2025-09-29 16:07:08,061 - INFO - 🌟 Populating star schema dimensions...
2025-09-29 16:07:08,061 - INFO - 🌟 Starting star schema dimension population...
2025-09-29 16:07:08,061 - INFO - 📍 Populating dim_locations...
2025-09-29 16:07:08,065 - INFO - 🚗 Populating dim_vendor...
2025-09-29 16:07:08,067 - INFO - 💳 Populating dim_payment_type...
2025-09-29 16:07:08,068 - INFO - 📊 Populating dim_rate_code...
2025-09-29 16:07:08,092 - INFO - ✅ Star schema dimensions populated successfully!
2025-09-29 16:07:08,092 - INFO - 🚕 Step 3: Loading Complete Trip Data
2025-09-29 16:07:08,093 - INFO - 🚕 Loading trip data...
2025-09-29 16:07:08,093 - INFO - 🔄 Backfill mode enabled: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-29 16:07:08,093 - INFO - 📅 Backfill months: 12 months from (2024, 9) to (2025, 8)
2025-09-29 16:07:08,094 - INFO - 📅 Processing 2024-09...
2025-09-29 16:07:08,095 - INFO - 🔄 2024-09: Already processed (3,633,030 records at 2025-09-29 13:20:27.906947)
2025-09-29 16:07:08,096 - INFO - 📅 Processing 2024-10...
2025-09-29 16:07:08,097 - INFO - 🔄 2024-10: Already processed (3,833,769 records at 2025-09-29 14:00:20.671467)
2025-09-29 16:07:08,098 - INFO - 📅 Processing 2024-11...
2025-09-29 16:07:08,098 - INFO - 🔄 2024-11: Already processed (3,646,369 records at 2025-09-29 14:36:35.042773)
2025-09-29 16:07:08,099 - INFO - 📅 Processing 2024-12...
2025-09-29 16:07:08,100 - INFO - 🔄 2024-12: Already processed (3,668,371 records at 2025-09-29 15:13:16.381364)
2025-09-29 16:07:08,100 - INFO - 📅 Processing 2025-01...
2025-09-29 16:07:08,101 - INFO - 🔄 2025-01: Already processed (3,475,226 records at 2025-09-29 15:48:40.332151)
2025-09-29 16:07:08,101 - INFO - 📅 Processing 2025-02...
2025-09-29 16:07:08,102 - WARNING - ⚠️ 2025-02: Previous processing incomplete, will retry
2025-09-29 16:07:08,108 - INFO - 📂 File already exists: yellow_tripdata_2025-02.parquet
2025-09-29 16:07:08,112 - INFO - 📝 Started processing log for 2025-02
2025-09-29 16:07:08,113 - INFO - 📥 Loading yellow_tripdata_2025-02.parquet...
2025-09-29 16:07:08,647 - INFO - 📊 File contains 3,577,543 rows
2025-09-29 16:07:09,379 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 16:07:13,579 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 16:07:34,720 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 16:07:37,981 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 16:08:01,574 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 16:08:04,765 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 16:08:28,612 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 16:08:31,799 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 16:08:59,661 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 16:09:02,951 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 16:09:28,571 - INFO - 📥 yellow_tripdata_2025-02.parquet: Processed 500,000 rows - Loaded: 0 normalized, 0 star, 500,000 duplicates, 0 invalid (5/36 chunks)
2025-09-29 16:09:28,572 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 16:09:31,777 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 16:09:54,984 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 16:09:58,165 - INFO - ✅ Generated 100,000 unique row hashes
