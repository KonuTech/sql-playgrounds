2025-09-29 16:36:38,397 - INFO - ğŸ“ Logging to file: /postgres/logs/2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08/log_20250929_163638.log
2025-09-29 16:36:38,397 - INFO - ğŸ•’ Execution started at: 2025-09-29T16:36:38.397631
2025-09-29 16:36:38,397 - INFO - âš™ï¸ Backfill configuration: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-29 16:36:38,398 - INFO - ğŸš€ Starting Complete NYC Taxi Database Initialization...
2025-09-29 16:36:38,403 - INFO - âœ… PostgreSQL is ready!
2025-09-29 16:36:38,405 - INFO - ğŸ”§ Step 1: Database Schema Creation
2025-09-29 16:36:38,405 - INFO - ğŸ—ƒï¸ Executing SQL initialization scripts...
2025-09-29 16:36:38,408 - INFO - ğŸ“„ Found 2 SQL scripts to execute
2025-09-29 16:36:38,412 - INFO - ğŸ”§ Executing: 00-postgis-setup.sql
2025-09-29 16:36:38,416 - INFO - âœ… Completed: 00-postgis-setup.sql
2025-09-29 16:36:38,416 - INFO - ğŸ”§ Executing: 01-nyc-taxi-schema.sql
2025-09-29 16:36:38,482 - INFO - âœ… Completed: 01-nyc-taxi-schema.sql
2025-09-29 16:36:38,482 - INFO - âœ… All SQL scripts executed successfully!
2025-09-29 16:36:38,483 - INFO - ğŸ“ Step 2: Loading Taxi Zone Reference Data
2025-09-29 16:36:38,483 - INFO - ğŸ“ Loading taxi zone reference data...
2025-09-29 16:36:38,483 - INFO - ğŸ§¹ Cleaning dictionary tables for fresh data load...
2025-09-29 16:36:38,509 - INFO - âœ… Dictionary tables cleaned
2025-09-29 16:36:38,510 - INFO - ğŸ“¥ Downloading taxi zone reference data...
2025-09-29 16:36:38,510 - INFO - ğŸ“¥ Downloading taxi zone reference data...
2025-09-29 16:36:38,511 - INFO - ğŸ“¥ Downloading taxi_zone_lookup.csv...
2025-09-29 16:36:38,602 - INFO - âœ… Downloaded: taxi_zone_lookup.csv
2025-09-29 16:36:38,602 - INFO - ğŸ“¥ Downloading taxi_zones.zip...
2025-09-29 16:36:38,743 - INFO - âœ… Downloaded: taxi_zones.zip
2025-09-29 16:36:38,794 - INFO - âœ… Extracted shapefile components
2025-09-29 16:36:38,795 - INFO - ğŸ—‘ï¸ Cleaned up ZIP file
2025-09-29 16:36:38,800 - INFO - âœ… All taxi zone reference data files are available
2025-09-29 16:36:38,823 - INFO - âœ… Loaded 263 taxi zones from CSV
2025-09-29 16:36:38,825 - INFO - ğŸ—ºï¸ Loading taxi zone shapes...
2025-09-29 16:36:39,105 - INFO - âœ… Loaded 263 taxi zone shapes
2025-09-29 16:36:39,105 - INFO - ğŸ“š Reloading lookup tables...
2025-09-29 16:36:39,109 - INFO - âœ… Lookup tables reloaded
2025-09-29 16:36:39,109 - INFO - ğŸŒŸ Populating star schema dimensions...
2025-09-29 16:36:39,109 - INFO - ğŸŒŸ Starting star schema dimension population...
2025-09-29 16:36:39,110 - INFO - ğŸ“ Populating dim_locations...
2025-09-29 16:36:39,111 - INFO - ğŸš— Populating dim_vendor...
2025-09-29 16:36:39,112 - INFO - ğŸ’³ Populating dim_payment_type...
2025-09-29 16:36:39,112 - INFO - ğŸ“Š Populating dim_rate_code...
2025-09-29 16:36:39,131 - INFO - âœ… Star schema dimensions populated successfully!
2025-09-29 16:36:39,131 - INFO - ğŸš• Step 3: Loading Complete Trip Data
2025-09-29 16:36:39,132 - INFO - ğŸš• Loading trip data...
2025-09-29 16:36:39,132 - INFO - ğŸ”„ Backfill mode enabled: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-29 16:36:39,132 - INFO - ğŸ“… Backfill months: 12 months from (2024, 9) to (2025, 8)
2025-09-29 16:36:39,133 - INFO - ğŸ“… Processing 2024-09...
2025-09-29 16:36:39,133 - WARNING - âš ï¸ 2024-09: Previous processing incomplete, will retry
2025-09-29 16:36:39,139 - INFO - ğŸ“¥ Downloading yellow_tripdata_2024-09.parquet from NYC TLC...
2025-09-29 16:36:40,171 - INFO - ğŸ“¥ Progress: 17.1% (10,485,760/61,170,186 bytes)
2025-09-29 16:36:41,142 - INFO - ğŸ“¥ Progress: 34.3% (20,971,520/61,170,186 bytes)
2025-09-29 16:36:42,117 - INFO - ğŸ“¥ Progress: 51.4% (31,457,280/61,170,186 bytes)
2025-09-29 16:36:43,081 - INFO - ğŸ“¥ Progress: 68.6% (41,943,040/61,170,186 bytes)
2025-09-29 16:36:44,048 - INFO - ğŸ“¥ Progress: 85.7% (52,428,800/61,170,186 bytes)
2025-09-29 16:36:44,855 - INFO - âœ… Downloaded: yellow_tripdata_2024-09.parquet (61,170,186 bytes)
2025-09-29 16:36:44,867 - INFO - ğŸ“ Started processing log for 2024-09
2025-09-29 16:36:44,868 - INFO - ğŸ“¥ Loading yellow_tripdata_2024-09.parquet...
2025-09-29 16:36:45,309 - INFO - ğŸ“Š File contains 3,633,030 rows
2025-09-29 16:36:45,911 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 16:36:46,832 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 16:37:09,741 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 16:37:12,985 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 16:37:37,855 - INFO - ğŸ—„ï¸ Populating dimension key cache for bulk operations...
2025-09-29 16:37:37,857 - INFO - âœ… Dimension cache populated: 263 locations, 2 vendors, 6 payment types, 6 rate codes
2025-09-29 16:37:39,832 - INFO - ğŸ“ Storing 1243 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 16:37:44,032 - WARNING - âš ï¸ Skipping 1243 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 16:38:10,812 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 16:38:14,032 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 16:38:38,924 - INFO - ğŸ“ Storing 1013 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 16:38:40,006 - WARNING - âš ï¸ Skipping 1013 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 16:39:08,243 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 16:39:11,401 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 16:39:34,457 - INFO - ğŸ“ Storing 1048 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 16:39:37,974 - WARNING - âš ï¸ Skipping 1048 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 16:40:06,330 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 16:40:09,573 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 16:40:32,772 - INFO - ğŸ“ Storing 1018 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 16:40:36,137 - WARNING - âš ï¸ Skipping 1018 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 16:41:03,964 - INFO - ğŸ“¥ yellow_tripdata_2024-09.parquet: Processed 500,000 rows - Loaded: 400,000 normalized, 395,678 star, 100,000 duplicates, 0 invalid (5/37 chunks)
2025-09-29 16:41:03,967 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 16:41:07,079 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 16:41:29,456 - INFO - ğŸ“ Storing 1056 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 16:41:32,957 - WARNING - âš ï¸ Skipping 1056 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 16:42:01,736 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 16:42:04,856 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 16:42:28,515 - INFO - ğŸ“ Storing 1042 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 16:42:32,007 - WARNING - âš ï¸ Skipping 1042 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 16:43:01,111 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 16:43:04,221 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 16:43:28,176 - INFO - ğŸ“ Storing 1175 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 16:43:32,127 - WARNING - âš ï¸ Skipping 1175 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 16:44:02,616 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 16:44:05,718 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 16:44:29,239 - INFO - ğŸ“ Storing 1038 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 16:44:32,684 - WARNING - âš ï¸ Skipping 1038 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 16:45:01,039 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 16:45:04,261 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 16:45:27,267 - INFO - ğŸ“ Storing 1035 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 16:45:30,706 - WARNING - âš ï¸ Skipping 1035 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 16:45:59,321 - INFO - ğŸ“¥ yellow_tripdata_2024-09.parquet: Processed 1,000,000 rows - Loaded: 900,000 normalized, 890,332 star, 100,000 duplicates, 0 invalid (10/37 chunks)
2025-09-29 16:45:59,324 - INFO - ğŸ” Calculating row hashes for duplicate prevention...
2025-09-29 16:46:02,474 - INFO - âœ… Generated 100,000 unique row hashes
2025-09-29 16:46:25,233 - INFO - ğŸ“ Storing 1067 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 16:46:28,737 - WARNING - âš ï¸ Skipping 1067 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
