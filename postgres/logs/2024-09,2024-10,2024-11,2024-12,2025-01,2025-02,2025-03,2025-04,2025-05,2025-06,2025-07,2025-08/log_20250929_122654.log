2025-09-29 12:26:54,946 - INFO - 📝 Logging to file: /postgres/logs/2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08/log_20250929_122654.log
2025-09-29 12:26:54,946 - INFO - 🕒 Execution started at: 2025-09-29T12:26:54.946749
2025-09-29 12:26:54,946 - INFO - ⚙️ Backfill configuration: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-29 12:26:54,947 - INFO - 🚀 Starting Complete NYC Taxi Database Initialization...
2025-09-29 12:26:54,957 - INFO - ✅ PostgreSQL is ready!
2025-09-29 12:26:54,959 - INFO - 🔧 Step 1: Database Schema Creation
2025-09-29 12:26:54,960 - INFO - 🗃️ Executing SQL initialization scripts...
2025-09-29 12:26:54,963 - INFO - 🔧 Creating superset database...
2025-09-29 12:26:55,100 - INFO - ✅ Superset database created successfully
2025-09-29 12:26:55,104 - INFO - 📄 Found 2 SQL scripts to execute
2025-09-29 12:26:55,109 - INFO - 🔧 Executing: 00-postgis-setup.sql
2025-09-29 12:26:55,113 - INFO - ✅ Completed: 00-postgis-setup.sql
2025-09-29 12:26:55,113 - INFO - 🔧 Executing: 01-nyc-taxi-schema.sql
2025-09-29 12:26:55,374 - INFO - ✅ Completed: 01-nyc-taxi-schema.sql
2025-09-29 12:26:55,374 - INFO - ✅ All SQL scripts executed successfully!
2025-09-29 12:26:55,375 - INFO - 📍 Step 2: Loading Taxi Zone Reference Data
2025-09-29 12:26:55,375 - INFO - 📍 Loading taxi zone reference data...
2025-09-29 12:26:55,375 - INFO - 🧹 Cleaning dictionary tables for fresh data load...
2025-09-29 12:26:55,404 - INFO - ✅ Dictionary tables cleaned
2025-09-29 12:26:55,405 - INFO - 📥 Downloading taxi zone reference data...
2025-09-29 12:26:55,405 - INFO - 📥 Downloading taxi zone reference data...
2025-09-29 12:26:55,408 - INFO - 📥 Downloading taxi_zone_lookup.csv...
2025-09-29 12:26:55,891 - INFO - ✅ Downloaded: taxi_zone_lookup.csv
2025-09-29 12:26:55,891 - INFO - 📥 Downloading taxi_zones.zip...
2025-09-29 12:26:56,034 - INFO - ✅ Downloaded: taxi_zones.zip
2025-09-29 12:26:56,084 - INFO - ✅ Extracted shapefile components
2025-09-29 12:26:56,086 - INFO - 🗑️ Cleaned up ZIP file
2025-09-29 12:26:56,092 - INFO - ✅ All taxi zone reference data files are available
2025-09-29 12:26:56,109 - INFO - ✅ Loaded 263 taxi zones from CSV
2025-09-29 12:26:56,111 - INFO - 🗺️ Loading taxi zone shapes...
2025-09-29 12:26:56,424 - INFO - ✅ Loaded 263 taxi zone shapes
2025-09-29 12:26:56,425 - INFO - 📚 Reloading lookup tables...
2025-09-29 12:26:56,431 - INFO - ✅ Lookup tables reloaded
2025-09-29 12:26:56,431 - INFO - 🌟 Populating star schema dimensions...
2025-09-29 12:26:56,432 - INFO - 🌟 Starting star schema dimension population...
2025-09-29 12:26:56,432 - INFO - 📍 Populating dim_locations...
2025-09-29 12:26:56,434 - INFO - 🚗 Populating dim_vendor...
2025-09-29 12:26:56,434 - INFO - 💳 Populating dim_payment_type...
2025-09-29 12:26:56,435 - INFO - 📊 Populating dim_rate_code...
2025-09-29 12:26:56,466 - INFO - ✅ Star schema dimensions populated successfully!
2025-09-29 12:26:56,466 - INFO - 🚕 Step 3: Loading Complete Trip Data
2025-09-29 12:26:56,466 - INFO - 🚕 Loading trip data...
2025-09-29 12:26:56,467 - INFO - 🔄 Backfill mode enabled: 2024-09,2024-10,2024-11,2024-12,2025-01,2025-02,2025-03,2025-04,2025-05,2025-06,2025-07,2025-08
2025-09-29 12:26:56,467 - INFO - 📅 Backfill months: 12 months from (2024, 9) to (2025, 8)
2025-09-29 12:26:56,468 - INFO - 📅 Processing 2024-09...
2025-09-29 12:26:56,472 - INFO - 📥 Downloading yellow_tripdata_2024-09.parquet from NYC TLC...
2025-09-29 12:26:57,493 - INFO - 📥 Progress: 17.1% (10,485,760/61,170,186 bytes)
2025-09-29 12:26:58,452 - INFO - 📥 Progress: 34.3% (20,971,520/61,170,186 bytes)
2025-09-29 12:26:59,412 - INFO - 📥 Progress: 51.4% (31,457,280/61,170,186 bytes)
2025-09-29 12:27:00,372 - INFO - 📥 Progress: 68.6% (41,943,040/61,170,186 bytes)
2025-09-29 12:27:01,331 - INFO - 📥 Progress: 85.7% (52,428,800/61,170,186 bytes)
2025-09-29 12:26:59,822 - INFO - ✅ Downloaded: yellow_tripdata_2024-09.parquet (61,170,186 bytes)
2025-09-29 12:26:59,831 - INFO - 📝 Started processing log for 2024-09
2025-09-29 12:26:59,831 - INFO - 📥 Loading yellow_tripdata_2024-09.parquet...
2025-09-29 12:27:00,347 - INFO - 📊 File contains 3,633,030 rows
2025-09-29 12:27:01,003 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 12:27:04,816 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 12:27:28,363 - INFO - 🗄️ Populating dimension key cache for bulk operations...
2025-09-29 12:27:28,366 - INFO - ✅ Dimension cache populated: 263 locations, 2 vendors, 6 payment types, 6 rate codes
2025-09-29 12:27:30,411 - INFO - 📝 Storing 1517 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 12:27:35,445 - WARNING - ⚠️ Skipping 1517 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 12:28:03,773 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 12:28:06,979 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 12:28:29,449 - INFO - 📝 Storing 1243 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 12:28:33,324 - WARNING - ⚠️ Skipping 1243 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 12:29:01,632 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 12:29:04,738 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 12:29:28,336 - INFO - 📝 Storing 1013 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 12:29:31,467 - WARNING - ⚠️ Skipping 1013 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 12:29:59,562 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 12:30:02,729 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 12:30:26,161 - INFO - 📝 Storing 1048 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 12:30:29,394 - WARNING - ⚠️ Skipping 1048 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 12:30:57,952 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 12:31:01,122 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 12:31:24,165 - INFO - 📝 Storing 1018 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 12:31:27,307 - WARNING - ⚠️ Skipping 1018 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 12:31:55,761 - INFO - 📥 yellow_tripdata_2024-09.parquet: Processed 500,000 rows - Loaded: 500,000 normalized, 494,161 star, 0 duplicates, 0 invalid (5/37 chunks)
2025-09-29 12:31:55,764 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 12:31:58,950 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 12:32:22,147 - INFO - 📝 Storing 1056 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 12:32:25,663 - WARNING - ⚠️ Skipping 1056 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 12:32:54,177 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 12:32:57,334 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 12:33:20,757 - INFO - 📝 Storing 1042 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 12:33:24,217 - WARNING - ⚠️ Skipping 1042 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 12:33:52,559 - INFO - 🔐 Calculating row hashes for duplicate prevention...
2025-09-29 12:33:55,664 - INFO - ✅ Generated 100,000 unique row hashes
2025-09-29 12:34:18,905 - INFO - 📝 Storing 1175 invalid rows in yellow_taxi_trips_invalid table
2025-09-29 12:34:22,599 - WARNING - ⚠️ Skipping 1175 rows with missing dimension keys or invalid dates (stored in yellow_taxi_trips_invalid)
2025-09-29 12:34:50,599 - INFO - 🔐 Calculating row hashes for duplicate prevention...
